<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="Admin">
	
<insert id="insertAdmin" parameterType="admin">
insert into admin_info_tb values (admin_info_tb_SEQ.NEXTVAL,#{ad_id},#{ad_password},#{ad_nickname},#{ad_grade})  
</insert>


<select id="adminIdCheck" parameterType="admin" resultType="admin">
      SELECT ADMIN_NICKNAME as ad_nickname FROM admin_info_tb
      WHERE ADMIN_ID = #{ad_id}
</select>
	
<select id="allMemberView" parameterType="member" resultType="member">
  SELECT 
  mb_id as memberId,
  mb_name as memberName,
  mb_nickname as memberNickName,
  mb_gender as memberGender,
  mb_birth as memberBirth,
  mb_email as memberEmail,
  mb_phone as memberPhone,
  mb_regDate as memberRegDate,
  MB_UPLOAD_PHOTO_FK as memberAvatar
  from member_entire_tb
</select>

<select id="allOwnerView" parameterType="owner" resultType="owner">
  SELECT 
  OW_ID as owId,
  OW_NAME as owName,
  OW_EMAIL as owEmail,
  OW_PHONE as phone,
  OW_REGDATE as owRegDate,
  OW_BANK_ACCOUNT as owBankAccount
  from OWNER_ENTIRE_TB
</select>


<select id="OwnerSearch" parameterType="map" resultType="owner">
SELECT  
  OW_ID as owId,
  OW_NAME as owName,
  OW_EMAIL as owEmail,
  OW_PHONE as phone,
  OW_REGDATE as owRegDate,
  OW_BANK_ACCOUNT as owBankAccount 
  FROM OWNER_ENTIRE_TB
  <where>
 <choose>
 <when test="combo == 'OwnerName'">
 OW_NAME LIKE '%'|| #{keyword} ||'%' 
  </when>
  
 <otherwise>
 OW_ID LIKE '%'|| #{keyword} ||'%' 
  </otherwise>
  
  </choose>
  </where>
</select>

<select id="MemberSearch" parameterType="map" resultType="member"> 
  SELECT 
  mb_id as memberId,
  mb_name as memberName,
  mb_nickname as memberNickName,
  mb_gender as memberGender,
  mb_birth as memberBirth,
  mb_email as memberEmail,
  mb_phone as memberPhone,
  mb_regDate as memberRegDate,
  MB_UPLOAD_PHOTO_FK as memberAvatar
  from member_entire_tb 
  where
 <choose>
 
 <when test="combo == 'MemberName'">
 MB_NAME LIKE '%'|| #{Keyword} ||'%' 

 </when>
  
 <when test="combo == 'MemberNickName'">
 MB_NICKNAME LIKE '%'|| #{Keyword} ||'%' 
 </when>
  
 <otherwise>
 MB_ID LIKE '%'|| #{Keyword} ||'%' 
 </otherwise>
</choose>


</select>


<select id="adminLogin" parameterType="admin" resultType="admin">
      SELECT 
      ADMIN_INFO_PK as admin_info_pk,
      ADMIN_ID as ad_id,
      ADMIN_PASSWORD as ad_password,
      ADMIN_NICKNAME as ad_nickname,
      ADMIN_ACCESS_GRADE_FK as ad_grade
      from admin_info_tb 
      where ADMIN_ID = #{ad_id} and ADMIN_PASSWORD = #{ad_password}
</select>

<select id="statAdmin" resultType="member">
      SELECT 
      count(*)
      from admin_info_tb 
      where memberGender = 'M'
</select>
 
<!--  통계 쿼리문 만드는중  
SELECT
    (SELECT COUNT(*) FROM MEMBER_entire_tb where MB_GENDER='M') boy, 
    (SELECT COUNT(*) FROM MEMBER_entire_tb where MB_GENDER='F') girl,
    (SELECT COUNT(*) FROM MEMBER_entire_tb WHERE (SELECT FLOOR(MONTHS_BETWEEN(SYSDATE,TO_DATE(MB_BIRTH,'YYMMDD'))/12)AS 만나이 from MEMBER_entire_tb) between 10 and 20) age1020,
    (SELECT COUNT(*) FROM MEMBER_entire_tb WHERE (SELECT FLOOR(MONTHS_BETWEEN(SYSDATE,TO_DATE(MB_BIRTH,'YYMMDD'))/12)AS 만나이 from MEMBER_entire_tb) between 20 and 30) age2030,
    (SELECT COUNT(*) FROM MEMBER_entire_tb WHERE (SELECT FLOOR(MONTHS_BETWEEN(SYSDATE,TO_DATE(MB_BIRTH,'YYMMDD'))/12)AS 만나이 from MEMBER_entire_tb) between 30 and 40) age3040,
    (SELECT COUNT(*) FROM MEMBER_entire_tb WHERE (SELECT FLOOR(MONTHS_BETWEEN(SYSDATE,TO_DATE(MB_BIRTH,'YYMMDD'))/12)AS 만나이 from MEMBER_entire_tb) between 40 and 50) age4050,
    (SELECT COUNT(*) FROM MEMBER_entire_tb WHERE (SELECT FLOOR(MONTHS_BETWEEN(SYSDATE,TO_DATE(MB_BIRTH,'YYMMDD'))/12)AS 만나이 from MEMBER_entire_tb) between 50 and 60) age5060,
    (SELECT COUNT(*) FROM MEMBER_entire_tb WHERE (SELECT FLOOR(MONTHS_BETWEEN(SYSDATE,TO_DATE(MB_BIRTH,'YYMMDD'))/12)AS 만나이 from MEMBER_entire_tb)>60) age60,
    (SELECT COUNT(*) FROM MEMBER_BOOK_TB where MB_BOOK_DATE >= to_date(SYSDATE,'hh24') 
  AND MB_BOOK_DATE <= to_date(SYSDATE,'hh24'))time0307 
FROM DUAL; -->


<!-- 
select * from owner_entire_tb;
update owner_entire_tb set ow_bank_account = SYSDATE where ow_id='ㅎㅇ';
SELECT FLOOR(MONTHS_BETWEEN(SYSDATE,TO_DATE(ow_bank_account,'YYMMDD'))/12)AS 만나이 from owner_entire_tb;


SELECT
    (SELECT COUNT(*) FROM MEMBER_entire_tb where MB_GENDER='M') boy, 
    (SELECT COUNT(*) FROM MEMBER_entire_tb where MB_GENDER='F') girl,
    (SELECT COUNT(*) FROM MEMBER_entire_tb WHERE (SELECT FLOOR(MONTHS_BETWEEN(SYSDATE,TO_DATE(MB_BIRTH,'YYMMDD'))/12)AS 만나이 from MEMBER_entire_tb) between 10 and 20) age1020,
    (SELECT COUNT(*) FROM MEMBER_entire_tb WHERE (SELECT FLOOR(MONTHS_BETWEEN(SYSDATE,TO_DATE(MB_BIRTH,'YYMMDD'))/12)AS 만나이 from MEMBER_entire_tb) between 20 and 30) age2030,
    (SELECT COUNT(*) FROM MEMBER_entire_tb WHERE (SELECT FLOOR(MONTHS_BETWEEN(SYSDATE,TO_DATE(MB_BIRTH,'YYMMDD'))/12)AS 만나이 from MEMBER_entire_tb) between 30 and 40) age3040,
    (SELECT COUNT(*) FROM MEMBER_entire_tb WHERE (SELECT FLOOR(MONTHS_BETWEEN(SYSDATE,TO_DATE(MB_BIRTH,'YYMMDD'))/12)AS 만나이 from MEMBER_entire_tb) between 40 and 50) age4050,
    (SELECT COUNT(*) FROM MEMBER_entire_tb WHERE (SELECT FLOOR(MONTHS_BETWEEN(SYSDATE,TO_DATE(MB_BIRTH,'YYMMDD'))/12)AS 만나이 from MEMBER_entire_tb) between 50 and 60) age5060,
    (SELECT COUNT(*) FROM MEMBER_entire_tb WHERE (SELECT FLOOR(MONTHS_BETWEEN(SYSDATE,TO_DATE(MB_BIRTH,'YYMMDD'))/12)AS 만나이 from MEMBER_entire_tb)>60) age60,
    (SELECT COUNT(*) FROM MEMBER_BOOK_TB where MB_BOOK_DATE >= to_date(SYSDATE,'hh24') 
  AND MB_BOOK_DATE <= to_date(SYSDATE,'hh24'))time0307 
FROM DUAL;


select to_char(sysdate,'hh24') from owner_entire_tb;

select count(*) from owner_entire_tb where (select to_char (sysdate,'hh24') from DUAL) between 15 and 19;
select ow_bank_account from owner_entire_tb;

select to_char(ow_bank_account,'hh24') from owner_entire_tb;



 -->




</mapper>
